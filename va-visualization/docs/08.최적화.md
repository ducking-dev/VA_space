# 08. ë°ì´í„° ë¡œë”© ì†ë„ ìµœì í™” ì „ëµì„œ

> **ëª©í‘œ**: 54,893ê°œ ê°ì • ë°ì´í„°ì˜ ë¡œë”© ì†ë„ë¥¼ 5-10ì´ˆì—ì„œ 1-2ì´ˆë¡œ ê°œì„   
> **ì›ì¹™**: SOLID ì›ì¹™ê³¼ ì±…ì„ ë¶„ë¦¬ ì›ì¹™ì„ ê¸°ë°˜ìœ¼ë¡œ í•œ í™•ì¥ ê°€ëŠ¥í•œ ìµœì í™” ì•„í‚¤í…ì²˜  
> **ë‚ ì§œ**: 2025ë…„ 1ì›” 27ì¼  
> **ìƒíƒœ**: ğŸŸ¢ Implemented - Phase 1 ì™„ë£Œ

---

## 1. ê°œìš”

### 1.1 ìµœì í™” ëª©í‘œ
- âš¡ **ë¡œë”© ì†ë„**: 5-10ì´ˆ â†’ 1-2ì´ˆ (80% ê°œì„ )
- ğŸ§  **ë©”ëª¨ë¦¬ íš¨ìœ¨ì„±**: 200MB+ â†’ 50MB (75% ê°œì„ )
- ğŸŒ **ë„¤íŠ¸ì›Œí¬ ìµœì í™”**: 15MB â†’ 4MB (73% ê°œì„ )
- ğŸ‘¤ **ì‚¬ìš©ì ê²½í—˜**: ë¸”ë¡œí‚¹ â†’ ì ì§„ì  ë¡œë”© (90% ê°œì„ )

### 1.2 í•µì‹¬ ì›ì¹™
- **SOLID ì›ì¹™**: ê° í´ë˜ìŠ¤ëŠ” ë‹¨ì¼ ì±…ì„ì„ ê°€ì§€ë©° í™•ì¥ ê°€ëŠ¥
- **ì±…ì„ ë¶„ë¦¬**: ë°ì´í„° ë¡œë”©, ë³€í™˜, ìºì‹±, ë Œë”ë§ì˜ ëª…í™•í•œ ë¶„ë¦¬
- **ì„±ëŠ¥ ìš°ì„ **: ì‚¬ìš©ì ê²½í—˜ì„ ìµœìš°ì„ ìœ¼ë¡œ í•˜ëŠ” ìµœì í™”
- **í™•ì¥ì„±**: í–¥í›„ ë°ì´í„° ì¦ê°€ì— ëŒ€ë¹„í•œ ì•„í‚¤í…ì²˜

---

## 2. ë³‘ëª© ì§€ì  ë¶„ì„ ë° ìš°ì„ ìˆœìœ„

### 2.1 ë³‘ëª© ì§€ì  ìš°ì„ ìˆœìœ„ ë§¤íŠ¸ë¦­ìŠ¤

| ìš°ì„ ìˆœìœ„ | ë³‘ëª© ì§€ì  | í˜„ì¬ ìƒíƒœ | ì˜í–¥ë„ | í•´ê²° ë‚œì´ë„ | ì˜ˆìƒ ê°œì„ ìœ¨ |
|----------|-----------|-----------|--------|-------------|-------------|
| **P0** | JSON íŒŒì¼ í¬ê¸° | ~15MB | ğŸ”´ Critical | ğŸŸ¡ Medium | 80% |
| **P0** | ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ | 200MB+ | ğŸ”´ Critical | ğŸŸ¡ Medium | 75% |
| **P1** | ë„¤íŠ¸ì›Œí¬ ì „ì†¡ | ë¹„ì••ì¶• | ğŸŸ¡ High | ğŸŸ¢ Easy | 70% |
| **P1** | ë°ì´í„° ë³€í™˜ | ë§¤ë²ˆ ì „ì²´ | ğŸŸ¡ High | ğŸŸ¡ Medium | 60% |
| **P2** | ìºì‹± ì „ëµ | ê¸°ë³¸ LRU | ğŸŸ¢ Medium | ğŸŸ¢ Easy | 40% |
| **P2** | ê²€ìƒ‰ ì„±ëŠ¥ | O(n) | ğŸŸ¢ Medium | ğŸŸ¡ Medium | 50% |

### 2.2 ë³‘ëª© ì§€ì  ìƒì„¸ ë¶„ì„

#### **P0: JSON íŒŒì¼ í¬ê¸° (Critical)**
- **í˜„ì¬**: 54,893ê°œ ê°ì²´ë¥¼ í•˜ë‚˜ì˜ JSON íŒŒì¼ì— ì €ì¥
- **ë¬¸ì œ**: ì „ì²´ ë°ì´í„°ë¥¼ í•œ ë²ˆì— ë¡œë“œí•´ì•¼ í•¨
- **í•´ê²°**: ì²­í¬ ê¸°ë°˜ ë¶„í•  + ì••ì¶•

#### **P0: ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ (Critical)**
- **í˜„ì¬**: ëª¨ë“  ë°ì´í„°ë¥¼ ë©”ëª¨ë¦¬ì— ë³´ê´€
- **ë¬¸ì œ**: ë¸Œë¼ìš°ì € ë©”ëª¨ë¦¬ í•œê³„ ì´ˆê³¼ ê°€ëŠ¥ì„±
- **í•´ê²°**: ê°€ìƒí™” + ì§€ì—° ë¡œë”©

#### **P1: ë„¤íŠ¸ì›Œí¬ ì „ì†¡ (High)**
- **í˜„ì¬**: ì••ì¶•ë˜ì§€ ì•Šì€ JSON ì „ì†¡
- **ë¬¸ì œ**: ëŒ€ì—­í­ ë‚­ë¹„ ë° ëŠë¦° ì „ì†¡
- **í•´ê²°**: Gzip ì••ì¶• + ìŠ¤íŠ¸ë¦¬ë°

---

## 3. SOLID ì›ì¹™ ê¸°ë°˜ ìµœì í™” ì•„í‚¤í…ì²˜

### 3.1 ì•„í‚¤í…ì²˜ ì„¤ê³„ ì›ì¹™

#### **3.1.1 Single Responsibility Principle (SRP)**
ê° í´ë˜ìŠ¤ëŠ” í•˜ë‚˜ì˜ ëª…í™•í•œ ì±…ì„ë§Œ ê°€ì§:

```typescript
// ë°ì´í„° ë¡œë”©ë§Œ ë‹´ë‹¹
class DataLoader {
  async loadChunk(chunkId: number): Promise<IEmotionData[]> { }
}

// ë°ì´í„° ë³€í™˜ë§Œ ë‹´ë‹¹
class DataTransformer {
  transformToRenderable(data: IEmotionData[]): IRenderablePoint[] { }
}

// ìºì‹±ë§Œ ë‹´ë‹¹
class CacheManager {
  get(key: string): any { }
  set(key: string, value: any): void { }
}
```

#### **3.1.2 Open/Closed Principle (OCP)**
ê¸°ì¡´ ì½”ë“œ ìˆ˜ì • ì—†ì´ ìƒˆë¡œìš´ ë¡œë”© ì „ëµ ì¶”ê°€ ê°€ëŠ¥:

```typescript
interface IDataLoadingStrategy {
  loadData(): Promise<IEmotionData[]>;
}

class ChunkedLoadingStrategy implements IDataLoadingStrategy {
  async loadData(): Promise<IEmotionData[]> { }
}

class StreamingLoadingStrategy implements IDataLoadingStrategy {
  async loadData(): Promise<IEmotionData[]> { }
}

class DataLoadingService {
  constructor(private strategy: IDataLoadingStrategy) {}
  
  async loadData(): Promise<IEmotionData[]> {
    return this.strategy.loadData();
  }
}
```

#### **3.1.3 Liskov Substitution Principle (LSP)**
ëª¨ë“  ë¡œë”© ì „ëµì€ ë™ì¼í•œ ì¸í„°í˜ì´ìŠ¤ë¡œ êµì²´ ê°€ëŠ¥:

```typescript
// ëª¨ë“  ì „ëµì´ ë™ì¼í•œ ì¸í„°í˜ì´ìŠ¤ êµ¬í˜„
const strategies = [
  new ChunkedLoadingStrategy(),
  new StreamingLoadingStrategy(),
  new CachedLoadingStrategy()
];

// ëŸ°íƒ€ì„ì— ì „ëµ êµì²´ ê°€ëŠ¥
strategies.forEach(strategy => {
  const service = new DataLoadingService(strategy);
  service.loadData(); // ë™ì¼í•œ ë°©ì‹ìœ¼ë¡œ í˜¸ì¶œ
});
```

#### **3.1.4 Interface Segregation Principle (ISP)**
í´ë¼ì´ì–¸íŠ¸ëŠ” í•„ìš”í•œ ì¸í„°í˜ì´ìŠ¤ë§Œ ì˜ì¡´:

```typescript
// ë¡œë”©ë§Œ í•„ìš”í•œ í´ë¼ì´ì–¸íŠ¸
interface IDataLoader {
  loadData(): Promise<IEmotionData[]>;
}

// ìºì‹±ë§Œ í•„ìš”í•œ í´ë¼ì´ì–¸íŠ¸
interface ICacheProvider {
  get(key: string): any;
  set(key: string, value: any): void;
}

// ë³€í™˜ë§Œ í•„ìš”í•œ í´ë¼ì´ì–¸íŠ¸
interface IDataTransformer {
  transform(data: IEmotionData[]): IRenderablePoint[];
}
```

#### **3.1.5 Dependency Inversion Principle (DIP)**
ê³ ìˆ˜ì¤€ ëª¨ë“ˆì€ ì €ìˆ˜ì¤€ ëª¨ë“ˆì— ì˜ì¡´í•˜ì§€ ì•ŠìŒ:

```typescript
// ê³ ìˆ˜ì¤€ ëª¨ë“ˆ (ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§)
class EmotionVisualizationService {
  constructor(
    private dataLoader: IDataLoader,
    private transformer: IDataTransformer,
    private cache: ICacheProvider
  ) {}
  
  async renderVisualization(): Promise<IRenderablePoint[]> {
    const data = await this.dataLoader.loadData();
    return this.transformer.transform(data);
  }
}

// ì €ìˆ˜ì¤€ ëª¨ë“ˆ (êµ¬í˜„ì²´)
class ChunkedDataLoader implements IDataLoader { }
class EmotionDataTransformer implements IDataTransformer { }
class LRUCache implements ICacheProvider { }
```

---

## 4. ì±…ì„ ë¶„ë¦¬ ì›ì¹™ ê¸°ë°˜ ëª¨ë“ˆ ì„¤ê³„

### 4.1 ê³„ì¸µë³„ ì±…ì„ ë¶„ë¦¬

#### **4.1.1 Data Layer (ë°ì´í„° ê³„ì¸µ)**
```typescript
// lib/data/
â”œâ”€â”€ loaders/           # ë°ì´í„° ë¡œë”© ì „ë‹´
â”‚   â”œâ”€â”€ ChunkedLoader.ts
â”‚   â”œâ”€â”€ StreamingLoader.ts
â”‚   â””â”€â”€ CachedLoader.ts
â”œâ”€â”€ transformers/      # ë°ì´í„° ë³€í™˜ ì „ë‹´
â”‚   â”œâ”€â”€ EmotionTransformer.ts
â”‚   â””â”€â”€ RenderableTransformer.ts
â”œâ”€â”€ indexers/          # ì¸ë±ì‹± ì „ë‹´
â”‚   â”œâ”€â”€ AlphabetIndexer.ts
â”‚   â””â”€â”€ SpatialIndexer.ts
â””â”€â”€ compressors/       # ì••ì¶•/í•´ì œ ì „ë‹´
    â”œâ”€â”€ GzipCompressor.ts
    â””â”€â”€ BrotliCompressor.ts
```

#### **4.1.2 Service Layer (ì„œë¹„ìŠ¤ ê³„ì¸µ)**
```typescript
// lib/services/
â”œâ”€â”€ DataLoadingService.ts    # ë¡œë”© ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜
â”œâ”€â”€ CacheService.ts          # ìºì‹œ ê´€ë¦¬
â”œâ”€â”€ PerformanceService.ts    # ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§
â””â”€â”€ VirtualizationService.ts # ê°€ìƒí™” ê´€ë¦¬
```

#### **4.1.3 Presentation Layer (í‘œí˜„ ê³„ì¸µ)**
```typescript
// lib/presentation/
â”œâ”€â”€ ProgressiveLoader.ts     # ì ì§„ì  ë¡œë”© UI
â”œâ”€â”€ LoadingIndicator.ts      # ë¡œë”© ìƒíƒœ í‘œì‹œ
â””â”€â”€ ErrorBoundary.ts         # ì—ëŸ¬ ì²˜ë¦¬
```

### 4.2 ëª¨ë“ˆ ê°„ ì˜ì¡´ì„± ê´€ë¦¬

```typescript
// ì˜ì¡´ì„± ì£¼ì… ì»¨í…Œì´ë„ˆ
class DIContainer {
  private services = new Map();
  
  register<T>(token: string, factory: () => T): void {
    this.services.set(token, factory);
  }
  
  resolve<T>(token: string): T {
    const factory = this.services.get(token);
    return factory();
  }
}

// ì„œë¹„ìŠ¤ ë“±ë¡
const container = new DIContainer();
container.register('dataLoader', () => new ChunkedDataLoader());
container.register('cache', () => new LRUCache());
container.register('transformer', () => new EmotionTransformer());

// ì„œë¹„ìŠ¤ ì‚¬ìš©
const dataLoader = container.resolve<IDataLoader>('dataLoader');
```

---

## 5. ìš°ì„ ìˆœìœ„ë³„ êµ¬í˜„ ì „ëµ

### 5.1 Phase 1: ì¦‰ì‹œ ì ìš© (1ì£¼ì°¨) - P0 ë³‘ëª© í•´ê²°

#### **5.1.1 ì²­í¬ ê¸°ë°˜ ë°ì´í„° ë¶„í• **

```typescript
// lib/data/loaders/ChunkedLoader.ts
export class ChunkedDataLoader implements IDataLoader {
  private static readonly CHUNK_SIZE = 1000;
  private static readonly MAX_CONCURRENT = 3;
  
  async loadData(): Promise<IEmotionData[]> {
    const totalChunks = await this.getTotalChunks();
    const allData: IEmotionData[] = [];
    
    // ì²­í¬ë³„ ë³‘ë ¬ ë¡œë”©
    for (let i = 0; i < totalChunks; i += ChunkedDataLoader.MAX_CONCURRENT) {
      const chunkPromises = [];
      
      for (let j = 0; j < ChunkedDataLoader.MAX_CONCURRENT && i + j < totalChunks; j++) {
        chunkPromises.push(this.loadChunk(i + j));
      }
      
      const chunks = await Promise.all(chunkPromises);
      chunks.forEach(chunk => allData.push(...chunk));
    }
    
    return allData;
  }
  
  private async loadChunk(chunkId: number): Promise<IEmotionData[]> {
    const response = await fetch(`/api/emotions/chunk/${chunkId}`);
    if (!response.ok) throw new Error(`Failed to load chunk ${chunkId}`);
    return response.json();
  }
  
  private async getTotalChunks(): Promise<number> {
    const response = await fetch('/api/emotions/metadata');
    const metadata = await response.json();
    return Math.ceil(metadata.totalCount / ChunkedDataLoader.CHUNK_SIZE);
  }
}
```

#### **5.1.2 ì••ì¶• API êµ¬í˜„**

```typescript
// app/api/emotions/chunk/[id]/route.ts
export async function GET(
  request: NextRequest,
  { params }: { params: { id: string } }
) {
  const chunkId = parseInt(params.id);
  const compress = request.nextUrl.searchParams.get('compress') === 'true';
  
  try {
    const chunkData = await loadChunkData(chunkId);
    
    if (compress) {
      const compressed = await gzip(JSON.stringify(chunkData));
      return new NextResponse(compressed, {
        headers: {
          'Content-Type': 'application/json',
          'Content-Encoding': 'gzip',
          'Cache-Control': 'public, max-age=3600',
        },
      });
    }
    
    return NextResponse.json(chunkData);
  } catch (error) {
    return NextResponse.json({ error: 'Chunk not found' }, { status: 404 });
  }
}

async function loadChunkData(chunkId: number): Promise<IEmotionData[]> {
  const dataPath = path.join(process.cwd(), 'public', 'data', 'chunks', `chunk_${chunkId}.json`);
  const fileContents = await fs.readFile(dataPath, 'utf8');
  return JSON.parse(fileContents);
}
```

#### **5.1.3 ì ì§„ì  ë¡œë”© UI**

```typescript
// lib/presentation/ProgressiveLoader.tsx
export function ProgressiveLoader() {
  const [progress, setProgress] = useState(0);
  const [loadedData, setLoadedData] = useState<IEmotionData[]>([]);
  const [isLoading, setIsLoading] = useState(false);
  
  const dataLoader = useMemo(() => new ChunkedDataLoader(), []);
  
  const loadData = useCallback(async () => {
    setIsLoading(true);
    setProgress(0);
    setLoadedData([]);
    
    try {
      await dataLoader.loadDataProgressively((progress, chunk) => {
        setProgress(progress);
        setLoadedData(prev => [...prev, ...chunk]);
      });
    } catch (error) {
      console.error('Failed to load data:', error);
    } finally {
      setIsLoading(false);
    }
  }, [dataLoader]);
  
  return (
    <div className="progressive-loader">
      <div className="progress-container">
        <div className="progress-bar">
          <div 
            className="progress-fill" 
            style={{ width: `${progress}%` }}
          />
        </div>
        <p className="progress-text">
          {isLoading ? `ë¡œë”© ì¤‘... ${progress.toFixed(1)}%` : 'ë¡œë”© ì™„ë£Œ'}
        </p>
      </div>
      
      {loadedData.length > 0 && (
        <ScatterPlot 
          data={loadedData} 
          isPartial={isLoading}
        />
      )}
    </div>
  );
}
```

### 5.2 Phase 2: ê³ ê¸‰ ìµœì í™” (2ì£¼ì°¨) - P1 ë³‘ëª© í•´ê²°

#### **5.2.1 ê°€ìƒí™” ë Œë”ë§**

```typescript
// lib/services/VirtualizationService.ts
export class VirtualizationService implements IVirtualizationService {
  private viewport: IViewport = { x: -1.1, y: -1.1, width: 2.2, height: 2.2 };
  private spatialIndex: Map<string, IEmotionData[]> = new Map();
  
  async getVisibleData(viewport: IViewport): Promise<IEmotionData[]> {
    // ê³µê°„ ì¸ë±ìŠ¤ ê¸°ë°˜ ë¹ ë¥¸ í•„í„°ë§
    const gridCells = this.getGridCells(viewport);
    const visibleData: IEmotionData[] = [];
    
    for (const cell of gridCells) {
      const cellData = this.spatialIndex.get(cell) || [];
      visibleData.push(...cellData);
    }
    
    // ë·°í¬íŠ¸ ë‚´ ë°ì´í„°ë§Œ ì •í™•íˆ í•„í„°ë§
    return visibleData.filter(point => 
      point.valence >= viewport.x &&
      point.valence <= viewport.x + viewport.width &&
      point.arousal >= viewport.y &&
      point.arousal <= viewport.y + viewport.height
    );
  }
  
  private getGridCells(viewport: IViewport): string[] {
    const gridSize = 0.1; // 10x10 ê·¸ë¦¬ë“œ
    const cells: string[] = [];
    
    const startX = Math.floor(viewport.x / gridSize);
    const endX = Math.ceil((viewport.x + viewport.width) / gridSize);
    const startY = Math.floor(viewport.y / gridSize);
    const endY = Math.ceil((viewport.y + viewport.height) / gridSize);
    
    for (let x = startX; x <= endX; x++) {
      for (let y = startY; y <= endY; y++) {
        cells.push(`${x},${y}`);
      }
    }
    
    return cells;
  }
}
```

#### **5.2.2 ì¸ë±ìŠ¤ ê¸°ë°˜ ê²€ìƒ‰**

```typescript
// lib/data/indexers/AlphabetIndexer.ts
export class AlphabetIndexer implements IDataIndexer {
  private index: Map<string, number[]> = new Map();
  private data: IEmotionData[] = [];
  
  async buildIndex(data: IEmotionData[]): Promise<void> {
    this.data = data;
    this.index.clear();
    
    // ì•ŒíŒŒë²³ë³„ ì¸ë±ìŠ¤ êµ¬ì¶•
    const alphabet = 'abcdefghijklmnopqrstuvwxyz';
    
    for (const letter of alphabet) {
      const indices: number[] = [];
      data.forEach((emotion, index) => {
        if (emotion.term.toLowerCase().startsWith(letter)) {
          indices.push(index);
        }
      });
      this.index.set(letter, indices);
    }
  }
  
  async searchByPrefix(prefix: string): Promise<IEmotionData[]> {
    const firstLetter = prefix[0].toLowerCase();
    const indices = this.index.get(firstLetter) || [];
    
    return indices
      .map(index => this.data[index])
      .filter(emotion => 
        emotion.term.toLowerCase().startsWith(prefix.toLowerCase())
      );
  }
  
  async searchByRange(
    valenceRange: [number, number],
    arousalRange: [number, number]
  ): Promise<IEmotionData[]> {
    return this.data.filter(emotion => 
      emotion.valence >= valenceRange[0] &&
      emotion.valence <= valenceRange[1] &&
      emotion.arousal >= arousalRange[0] &&
      emotion.arousal <= arousalRange[1]
    );
  }
}
```

### 5.3 Phase 3: ê³ ê¸‰ ìºì‹± (3ì£¼ì°¨) - P2 ë³‘ëª© í•´ê²°

#### **5.3.1 ë‹¤ì¸µ ìºì‹± ì‹œìŠ¤í…œ**

```typescript
// lib/services/CacheService.ts
export class CacheService implements ICacheService {
  private memoryCache: LRUCache<any>;
  private indexedDBCache: IDBWrapper;
  private serviceWorkerCache: ServiceWorkerCache;
  
  constructor() {
    this.memoryCache = new LRUCache(100); // 100ê°œ í•­ëª©
    this.indexedDBCache = new IDBWrapper('emotion-cache');
    this.serviceWorkerCache = new ServiceWorkerCache();
  }
  
  async get<T>(key: string): Promise<T | null> {
    // 1ë‹¨ê³„: ë©”ëª¨ë¦¬ ìºì‹œ í™•ì¸
    let data = this.memoryCache.get(key);
    if (data) return data;
    
    // 2ë‹¨ê³„: IndexedDB í™•ì¸
    data = await this.indexedDBCache.get(key);
    if (data) {
      this.memoryCache.set(key, data); // ë©”ëª¨ë¦¬ ìºì‹œì— ë³µì›
      return data;
    }
    
    // 3ë‹¨ê³„: Service Worker ìºì‹œ í™•ì¸
    data = await this.serviceWorkerCache.get(key);
    if (data) {
      this.memoryCache.set(key, data);
      await this.indexedDBCache.set(key, data);
      return data;
    }
    
    return null;
  }
  
  async set<T>(key: string, value: T, ttl: number = 3600000): Promise<void> {
    // ëª¨ë“  ìºì‹œ ë ˆë²¨ì— ì €ì¥
    this.memoryCache.set(key, value);
    await this.indexedDBCache.set(key, value, ttl);
    await this.serviceWorkerCache.set(key, value, ttl);
  }
}
```

#### **5.3.2 Web Workers ë°±ê·¸ë¼ìš´ë“œ ì²˜ë¦¬**

```typescript
// public/workers/dataProcessor.worker.ts
self.onmessage = function(e) {
  const { type, data, id } = e.data;
  
  switch (type) {
    case 'PROCESS_EMOTIONS':
      const processed = data.map(emotion => ({
        ...emotion,
        // ë³µì¡í•œ ê³„ì‚° ì‘ì—…
        normalizedValence: (emotion.valence + 1) / 2,
        normalizedArousal: (emotion.arousal + 1) / 2,
        confidence: calculateConfidence(emotion),
        category: categorizeEmotion(emotion),
      }));
      
      self.postMessage({ type: 'PROCESSED', data: processed, id });
      break;
      
    case 'BUILD_INDEX':
      const index = buildSpatialIndex(data);
      self.postMessage({ type: 'INDEX_BUILT', data: index, id });
      break;
  }
};

function calculateConfidence(emotion: IEmotionData): number {
  // ì‹ ë¢°ë„ ê³„ì‚° ë¡œì§
  return Math.random(); // ì„ì‹œ êµ¬í˜„
}

function categorizeEmotion(emotion: IEmotionData): string {
  // ê°ì • ì¹´í…Œê³ ë¦¬ ë¶„ë¥˜ ë¡œì§
  if (emotion.valence > 0.5 && emotion.arousal > 0.5) return 'joy';
  if (emotion.valence < -0.5 && emotion.arousal > 0.5) return 'anger';
  return 'neutral';
}

function buildSpatialIndex(data: IEmotionData[]): Map<string, IEmotionData[]> {
  const index = new Map();
  const gridSize = 0.1;
  
  data.forEach(emotion => {
    const x = Math.floor(emotion.valence / gridSize);
    const y = Math.floor(emotion.arousal / gridSize);
    const key = `${x},${y}`;
    
    if (!index.has(key)) {
      index.set(key, []);
    }
    index.get(key).push(emotion);
  });
  
  return index;
}
```

---

## 6. ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§ ë° ì¸¡ì •

### 6.1 ì„±ëŠ¥ ì§€í‘œ ì •ì˜

```typescript
// lib/services/PerformanceService.ts
export class PerformanceService {
  private metrics: Map<string, number[]> = new Map();
  
  startTiming(label: string): () => void {
    const startTime = performance.now();
    
    return () => {
      const endTime = performance.now();
      const duration = endTime - startTime;
      
      if (!this.metrics.has(label)) {
        this.metrics.set(label, []);
      }
      this.metrics.get(label)!.push(duration);
      
      console.log(`${label}: ${duration.toFixed(2)}ms`);
    };
  }
  
  getMetrics(): Record<string, { avg: number; min: number; max: number }> {
    const result: Record<string, any> = {};
    
    for (const [label, times] of this.metrics) {
      result[label] = {
        avg: times.reduce((a, b) => a + b, 0) / times.length,
        min: Math.min(...times),
        max: Math.max(...times),
      };
    }
    
    return result;
  }
}
```

### 6.2 Web Vitals ì¶”ì 

```typescript
// lib/analytics/WebVitals.ts
import { getCLS, getFID, getFCP, getLCP, getTTFB } from 'web-vitals';

export function trackWebVitals() {
  getCLS(metric => reportMetric('CLS', metric));
  getFID(metric => reportMetric('FID', metric));
  getFCP(metric => reportMetric('FCP', metric));
  getLCP(metric => reportMetric('LCP', metric));
  getTTFB(metric => reportMetric('TTFB', metric));
}

function reportMetric(name: string, metric: any) {
  console.log(`${name}:`, metric.value);
  
  // ì™¸ë¶€ ë¶„ì„ ì„œë¹„ìŠ¤ë¡œ ì „ì†¡
  if (process.env.NODE_ENV === 'production') {
    // Google Analytics, DataDog ë“±
  }
}
```

---

## 7. êµ¬í˜„ ë¡œë“œë§µ

### 7.1 1ì£¼ì°¨: ê¸°ë³¸ ìµœì í™”
- [x] ì²­í¬ ê¸°ë°˜ ë°ì´í„° ë¶„í•  êµ¬í˜„
- [x] ì••ì¶• API êµ¬í˜„
- [x] ì ì§„ì  ë¡œë”© UI êµ¬í˜„
- [ ] ê¸°ë³¸ ì„±ëŠ¥ ì¸¡ì • ë„êµ¬ ì„¤ì •

### 7.2 2ì£¼ì°¨: ê³ ê¸‰ ìµœì í™”
- [ ] ê°€ìƒí™” ë Œë”ë§ êµ¬í˜„
- [ ] ì¸ë±ìŠ¤ ê¸°ë°˜ ê²€ìƒ‰ êµ¬í˜„
- [ ] ê³µê°„ ë¶„í•  ì¸ë±ì‹± êµ¬í˜„
- [ ] ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ìµœì í™”

### 7.3 3ì£¼ì°¨: ìºì‹± ë° ë°±ê·¸ë¼ìš´ë“œ ì²˜ë¦¬
- [ ] ë‹¤ì¸µ ìºì‹± ì‹œìŠ¤í…œ êµ¬í˜„
- [ ] Web Workers ë°±ê·¸ë¼ìš´ë“œ ì²˜ë¦¬
- [ ] Service Worker ìºì‹± êµ¬í˜„
- [ ] IndexedDB í†µí•©

### 7.4 4ì£¼ì°¨: ëª¨ë‹ˆí„°ë§ ë° ìµœì í™”
- [ ] ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§ ì‹œìŠ¤í…œ êµ¬ì¶•
- [ ] Web Vitals ì¶”ì  êµ¬í˜„
- [ ] ì„±ëŠ¥ ë²¤ì¹˜ë§ˆí¬ í…ŒìŠ¤íŠ¸
- [ ] ìµœì¢… ìµœì í™” ë° íŠœë‹

---

## 8. ì˜ˆìƒ ì„±ëŠ¥ ê°œì„  ê²°ê³¼

### 8.1 ì •ëŸ‰ì  ê°œì„  ì§€í‘œ

| ì§€í‘œ | í˜„ì¬ | ëª©í‘œ | ê°œì„ ìœ¨ |
|------|------|------|--------|
| **ì´ˆê¸° ë¡œë”© ì‹œê°„** | 5-10ì´ˆ | 1-2ì´ˆ | 80% â†“ |
| **ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰** | 200MB+ | 50MB | 75% â†“ |
| **ë„¤íŠ¸ì›Œí¬ ì „ì†¡ëŸ‰** | 15MB | 4MB | 73% â†“ |
| **ê²€ìƒ‰ ì‘ë‹µ ì‹œê°„** | 500ms | 50ms | 90% â†“ |
| **ë Œë”ë§ FPS** | 30fps | 60fps | 100% â†‘ |

### 8.2 ì‚¬ìš©ì ê²½í—˜ ê°œì„ 

- **ì¦‰ì‹œ ë°˜ì‘**: ì²« ë²ˆì§¸ ì²­í¬ ë¡œë”© í›„ ì¦‰ì‹œ ì‹œê°í™” ì‹œì‘
- **ì ì§„ì  ê°œì„ **: ë°ì´í„°ê°€ ë¡œë”©ë ìˆ˜ë¡ ì‹œê°í™” í’ˆì§ˆ í–¥ìƒ
- **ë¶€ë“œëŸ¬ìš´ ìƒí˜¸ì‘ìš©**: ê°€ìƒí™”ë¡œ ì¸í•œ 60fps ìœ ì§€
- **ì˜¤í”„ë¼ì¸ ì§€ì›**: Service Worker ìºì‹±ìœ¼ë¡œ ì˜¤í”„ë¼ì¸ ì‚¬ìš© ê°€ëŠ¥

---

## 9. ê²°ë¡ 

SOLID ì›ì¹™ê³¼ ì±…ì„ ë¶„ë¦¬ ì›ì¹™ì„ ì ìš©í•œ ë°ì´í„° ë¡œë”© ìµœì í™” ì „ëµì„ í†µí•´:

1. **í™•ì¥ ê°€ëŠ¥í•œ ì•„í‚¤í…ì²˜**: ìƒˆë¡œìš´ ìµœì í™” ì „ëµì„ ì‰½ê²Œ ì¶”ê°€ ê°€ëŠ¥
2. **ìœ ì§€ë³´ìˆ˜ì„± í–¥ìƒ**: ê° ëª¨ë“ˆì˜ ëª…í™•í•œ ì±…ì„ìœ¼ë¡œ ë””ë²„ê¹… ë° ìˆ˜ì • ìš©ì´
3. **ì„±ëŠ¥ ìµœì í™”**: 80% ì´ìƒì˜ ë¡œë”© ì†ë„ ê°œì„ 
4. **ì‚¬ìš©ì ê²½í—˜ ê°œì„ **: ì ì§„ì  ë¡œë”©ìœ¼ë¡œ ì¦‰ì‹œ ë°˜ì‘í•˜ëŠ” UI

ì´ ì „ëµì„ ë‹¨ê³„ì ìœ¼ë¡œ êµ¬í˜„í•˜ë©´ 54,893ê°œ ê°ì • ë°ì´í„°ì˜ íš¨ìœ¨ì ì¸ ë¡œë”©ê³¼ ì‹œê°í™”ê°€ ê°€ëŠ¥í•´ì§‘ë‹ˆë‹¤.

---

**ì‘ì„±ì¼**: 2025ë…„ 1ì›” 27ì¼  
**ì‘ì„±ì**: VEATIC ì—°êµ¬íŒ€  
**ë²„ì „**: v1.0  
**ìƒíƒœ**: ğŸ”´ Critical - ì¦‰ì‹œ êµ¬í˜„ í•„ìš”

---

## 10. ìˆ˜ì • ë‚´ì—­ (2025-10-05)

### Phase 1: P0 ë³‘ëª© í•´ê²° (ë°ì´í„° ì²­í‚¹ ë° ì ì§„ì  ë¡œë”©) êµ¬í˜„ ì™„ë£Œ

- **ëª©í‘œ**: ì´ˆê¸° ë°ì´í„° ë¡œë”© ì‹œ ë°œìƒí•˜ëŠ” ì‹¬ê°í•œ ì„±ëŠ¥ ì €í•˜ ë¬¸ì œ í•´ê²°
- **ìƒíƒœ**: **ì™„ë£Œ**

#### ì£¼ìš” ë³€ê²½ ì‚¬í•­:

1.  **ë°ì´í„° ì²­í‚¹ (`scripts/chunk-data.js`)**:
    *   ê¸°ì¡´ì˜ 15MB `merged_vad.json` íŒŒì¼ì„ 1000ê°œ ë‹¨ìœ„ì˜ ì²­í¬ 55ê°œë¡œ ë¶„í• í•˜ëŠ” ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì¶”ê°€í–ˆìŠµë‹ˆë‹¤.
    *   `public/data/chunks/` ë””ë ‰í† ë¦¬ì— `chunk_*.json` í˜•íƒœë¡œ ì €ì¥ë©ë‹ˆë‹¤.
    *   ë°ì´í„°ì…‹ì˜ ë©”íƒ€ ì •ë³´ (`totalCount`, `chunkSize`)ë¥¼ ë‹´ì€ `metadata.json` íŒŒì¼ì„ ìƒì„±í•˜ì—¬ APIì—ì„œ í™œìš©í•˜ë„ë¡ í–ˆìŠµë‹ˆë‹¤.

2.  **ì‹ ê·œ API ì—”ë“œí¬ì¸íŠ¸ êµ¬í˜„**:
    *   `GET /api/emotions/metadata`: ë°ì´í„°ì…‹ì˜ ì „ì²´ í¬ê¸° ë° ì²­í¬ ì •ë³´ë¥¼ ì œê³µí•˜ëŠ” ì—”ë“œí¬ì¸íŠ¸ë¥¼ ì¶”ê°€í–ˆìŠµë‹ˆë‹¤.
    *   `GET /api/emotions/chunk/[id]`: íŠ¹ì • ë°ì´í„° ì²­í¬ë¥¼ ì œê³µí•˜ëŠ” ë™ì  ë¼ìš°íŠ¸ë¥¼ ì¶”ê°€í–ˆìŠµë‹ˆë‹¤. `?compress=true` ì¿¼ë¦¬ íŒŒë¼ë¯¸í„°ë¥¼ í†µí•´ Gzip ì••ì¶• ì „ì†¡ì„ ì§€ì›í•˜ì—¬ ë„¤íŠ¸ì›Œí¬ ì „ì†¡ëŸ‰ì„ í¬ê²Œ ì¤„ì˜€ìŠµë‹ˆë‹¤.

3.  **ë°ì´í„° ë¡œë” ë¦¬íŒ©í† ë§ (`lib/data/loaders/`)**:
    *   SOLID ì›ì¹™ì— ë”°ë¼ ë°ì´í„° ë¡œë”© ì±…ì„ì„ ë¶„ë¦¬í•˜ê¸° ìœ„í•´ `IDataLoader` ì¸í„°í˜ì´ìŠ¤ì™€ `ChunkedDataLoader` í´ë˜ìŠ¤ë¥¼ ë„ì…í–ˆìŠµë‹ˆë‹¤.
    *   `ChunkedDataLoader`ëŠ” ë©”íƒ€ë°ì´í„°ë¥¼ ë¨¼ì € ì¡°íšŒí•œ í›„, ì—¬ëŸ¬ ì²­í¬ë¥¼ ë³‘ë ¬ë¡œ ìš”ì²­í•˜ì—¬ ë¡œë”© ì†ë„ë¥¼ ê·¹ëŒ€í™”í•©ë‹ˆë‹¤.

4.  **`useEmotionData` í›… ê°œì„  (`lib/hooks/data/useEmotionData.ts`)**:
    *   ìƒˆë¡œìš´ `ChunkedDataLoader`ë¥¼ ì‚¬ìš©í•˜ë„ë¡ í›…ì„ ì „ë©´ ë¦¬íŒ©í† ë§í–ˆìŠµë‹ˆë‹¤.
    *   ë°ì´í„° ë¡œë”© ì§„í–‰ë¥ (`progress`) ìƒíƒœë¥¼ ì¶”ê°€í•˜ì—¬ UIì— ë¡œë”© ìƒíƒœë¥¼ ë³´ë‹¤ ìƒì„¸íˆ í‘œì‹œí•  ìˆ˜ ìˆë„ë¡ í–ˆìŠµë‹ˆë‹¤.
    *   ë°ì´í„°ë¥¼ ì ì§„ì ìœ¼ë¡œ ìƒíƒœì— ì¶”ê°€í•˜ì—¬, ì²­í¬ê°€ ë„ì°©í•˜ëŠ” ì¦‰ì‹œ í™”ë©´ì— ë Œë”ë§í•  ìˆ˜ ìˆëŠ” ê¸°ë°˜ì„ ë§ˆë ¨í–ˆìŠµë‹ˆë‹¤.

5.  **ì ì§„ì  ë¡œë”© UI (`app/page.tsx`)**:
    *   ê¸°ì¡´ì˜ ë‹¨ìˆœ ìŠ¤í”¼ë„ˆë¥¼ ë¡œë”© ì§„í–‰ë¥ ì„ ë³´ì—¬ì£¼ëŠ” í”„ë¡œê·¸ë ˆìŠ¤ ë°”ë¡œ êµì²´í–ˆìŠµë‹ˆë‹¤.
    *   `useEmotionData` í›…ì—ì„œ ì œê³µí•˜ëŠ” `progress` ê°’ì„ ì‚¬ìš©í•˜ì—¬ ì‚¬ìš©ìì—ê²Œ ëª…í™•í•œ í”¼ë“œë°±ì„ ì œê³µí•©ë‹ˆë‹¤.
    *   ë°ì´í„°ê°€ ë¡œë”©ë˜ëŠ” ë™ì•ˆì—ë„ `ScatterPlot` ì»´í¬ë„ŒíŠ¸ê°€ ë¶€ë¶„ì ìœ¼ë¡œ ë Œë”ë§ë˜ë„ë¡ `isPartial` ì†ì„±ì„ ì¶”ê°€í•˜ì—¬ ì‚¬ìš©ì ê²½í—˜ì„ ê°œì„ í–ˆìŠµë‹ˆë‹¤.

6.  **ì½”ë“œ ì •ë¦¬**:
    *   ìƒˆë¡œìš´ ì•„í‚¤í…ì²˜ ë„ì…ì— ë”°ë¼ ë” ì´ìƒ ì‚¬ìš©ë˜ì§€ ì•ŠëŠ” ê¸°ì¡´ íŒŒì¼(`lib/services/EmotionDataLoader.ts`, `app/api/emotions/route.ts`)ì„ ì‚­ì œí•˜ì—¬ ì½”ë“œë² ì´ìŠ¤ë¥¼ ì •ë¦¬í–ˆìŠµë‹ˆë‹¤.

#### ê¸°ëŒ€ íš¨ê³¼:

- **ì´ˆê¸° ë¡œë”© ì‹œê°„ ë‹¨ì¶•**: ì „ì²´ ë°ì´í„°ë¥¼ í•œ ë²ˆì— ë¡œë“œí•˜ëŠ” ëŒ€ì‹  ì‘ì€ ì²­í¬ë“¤ì„ ë³‘ë ¬ë¡œ ë¡œë“œí•˜ì—¬ ì‚¬ìš©ìê°€ ì²« ë°ì´í„°ë¥¼ ë³´ê¸°ê¹Œì§€ì˜ ì‹œê°„ì´ í¬ê²Œ ë‹¨ì¶•ë˜ì—ˆìŠµë‹ˆë‹¤.
- **ë„¤íŠ¸ì›Œí¬ íš¨ìœ¨ì„± ì¦ëŒ€**: Gzip ì••ì¶•ì„ í†µí•´ ì‹¤ì œ ì „ì†¡ë˜ëŠ” ë°ì´í„°ì˜ í¬ê¸°ë¥¼ ì¤„ì˜€ìŠµë‹ˆë‹¤.
- **ì‚¬ìš©ì ê²½í—˜ í–¥ìƒ**: í”„ë¡œê·¸ë ˆìŠ¤ ë°”ë¥¼ í†µí•´ ì‚¬ìš©ìì—ê²Œ ë¡œë”© ìƒíƒœë¥¼ ëª…í™•íˆ ì•Œë ¤ì£¼ê³ , ë°ì´í„°ê°€ ë¡œë”©ë˜ëŠ” ëŒ€ë¡œ ì‹œê°í™”ê°€ ê°±ì‹ ë˜ì–´ ì‹œìŠ¤í…œì´ ì¦‰ê°ì ìœ¼ë¡œ ë°˜ì‘í•˜ëŠ” ê²ƒì²˜ëŸ¼ ëŠê»´ì§€ê²Œ í•©ë‹ˆë‹¤.